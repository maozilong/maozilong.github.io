var m=Object.defineProperty;var u=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var c=(e,t,a)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,d=(e,t)=>{for(var a in t||(t={}))y.call(t,a)&&c(e,a,t[a]);if(u)for(var a of u(t))b.call(t,a)&&c(e,a,t[a]);return e};import{n as p}from"./index.a838637d.js";import{e as h}from"./vendor.1d8a023a.js";var w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[a("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(i){e.currentPage=i},"update:current-page":function(i){e.currentPage=i},"update:pageSize":function(i){e.pageSize=i},"update:page-size":function(i){e.pageSize=i},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},$=[];const x={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get(){return this.page},set(e){this.$emit("update:page",e)}},pageSize:{get(){return this.limit},set(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll},handleCurrentChange(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll}}},g={};var S=p(x,w,$,!1,z,"2e3ce0ac",null,null);function z(e){for(let t in g)this[t]=g[t]}var C=function(){return S.exports}(),R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",e._g(e._b({directives:[{name:"loading",rawName:"v-loading",value:e.$store.state.loading,expression:"$store.state.loading"}],ref:"table",attrs:{height:e.$props.height||e.innerHeight,data:e.dataRender},on:{"selection-change":e.selectionChange,"row-click":e.rowClick}},"el-table",e.$props,!1),e.$listeners),[e._l(e.columnsRender,function(i,l){return[a("el-table-column",e._b({key:l,attrs:{sortable:e.sortable},scopedSlots:e._u([i.slotScope?{key:"default",fn:function(n){var r=n.row,o=n.$index;return[i.slotScope?e._t(i.slotScope,null,{scope:{row:r,$index:o}}):e._e()]}}:i.dictionary?{key:"default",fn:function(n){var r=n.row;return[e._v(" "+e._s(e.$utils.dictionaryTran(i.dictionary,r[i.prop]))+" ")]}}:i.propName?{key:"default",fn:function(n){var r=n.row;return[e._v(" "+e._s(r[i.propName])+" ")]}}:i.type==="upload"?{key:"default",fn:function(n){var r=n.row;return[r[i.prop]?a("div",{staticStyle:{"line-height":"0"}},[a("el-avatar",{attrs:{shape:"square",size:30,src:r[i.prop][0]&&r[i.prop][0].url},nativeOn:{click:function(o){return e.handlePictureCardPreview(o)}}})],1):e._e()]}}:i.buttons?{key:"default",fn:function(n){var r=n.row,o=n.$index;return e._l(i.buttons,function(s,_){return a("el-button",e._b({key:_,attrs:{disabled:s.disabledRender?s.disabledRender(r):s.disabled},on:{click:function(v){v.stopPropagation(),s.act?e.act(s.act,r,o):s.click(r,o)}}},"el-button",s,!1),[e._v(e._s(s.label))])})}}:null],null,!0)},"el-table-column",i,!1))]})],2),a("pagination",e._g({directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.page,limit:e.limit},on:{"update:page":function(i){e.page=i},"update:limit":function(i){e.limit=i},pagination:e.refresh}},e.$listeners)),a("el-dialog",{attrs:{title:"\u56FE\u7247\u9884\u89C8",visible:e.dialogVisible,top:"60px","append-to-body":""},on:{"update:visible":function(i){e.dialogVisible=i}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)},k=[];const P={name:"MTable",components:{Pagination:C},props:Object.assign(d({},h.exports.Table.props),{columns:{type:Array,default(){return[]}},border:{type:Boolean,default:!0},sortable:{type:Boolean,default:!1},rowKey:{type:[String,Function],default:"id"},initLoad:{type:Boolean,default:!0},url:{type:String,default:""},url_del:{type:String,default:""},method:{type:String,default:"get"},query:{type:Object,default:function(){return{}}},selection:{type:Boolean,default:!0},index:{type:Boolean,default:!0},actionColumn:{type:Object,default:()=>({label:"\u64CD\u4F5C",sortable:!1,fixed:"right",width:150,buttons:[{label:"\u4FEE\u6539",type:"text",auth:"edit",act:"edit"},{label:"\u5220\u9664",type:"text",auth:"del",act:"del"}]})}}),data(){return{innerHeight:window.innerHeight-232,dialogVisible:!1,dialogImageUrl:"",listLoading:!1,list:[],total:0,page:1,limit:10,selectedRows:[]}},computed:{dataRender(){const{url:e,list:t,data:a}=this;return e?t:a},columnsRender(){const e={type:"selection",sortable:!1,align:"center",width:40},t={type:"index",label:"\u5E8F\u53F7",align:"center",width:50},{columns:a,selection:i,index:l}=this,n=[...a];return l&&n.unshift(t),i&&n.unshift(e),n.push(this.actionColumn),n}},watch:{dataRender(){this.url||(this.total=this.dataRender.length)}},created(){for(const e in h.exports.Table.methods)this[e]||(this[e]=(...t)=>{this.$refs.table[e](...t)});this.resize(),this.url?this.initLoad&&this.search():this.total=this.dataRender.length},mounted(){window.addEventListener("resize",this.resize)},beforeDestroy(){window.removeEventListener("resize",this.resize)},methods:{search(e={}){this.selectedRows=[],this.page=e.page||1;const{query:t,url:a,method:i,page:l,limit:n}=this;if(!a)return;const r=Object.assign({page:l,limit:n},t,e);this.opt=r;const o=i==="get"?{params:r}:r;this.$http[i](a,o).then(s=>{this.total=s.data.total,this.list=s.data.records}).catch(()=>{this.localLoading=!1})},refresh(e={}){this.search(d(d({},this.opt),e))},act(e,t,a){this[e](d({},t),a)},edit(e,t){this.$emit("open",e,t)},del({id:e},t){this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u8BE5\u8BB0\u5F55, \u662F\u5426\u7EE7\u7EED?","\u8B66\u544A",{type:"warning"}).then(()=>{if(this.url_del)this.$http.request({url:this.url_del,data:{id:e},method:"post"}).then(()=>{this.refresh()});else if(typeof t=="object")for(let a=t.length-1;a>=0;a--)this.data.splice(t[a],1),this.selectedRows.splice(t[a],1);else this.data.splice(t,1),this.selectedRows.splice(t,1)})},selectionChange(e){this.selectedRows=e;const t=[];e.forEach((a,i)=>{const l=this.dataRender.indexOf(a);l>-1&&t.push(l)}),t.sort((a,i)=>a-i),this.selectedIndex=t},rowClick(e,t,a){this.toggleRowSelection(e)},handlePictureCardPreview(e){this.dialogVisible=!0,this.dialogImageUrl=e.target.src},resize(){this.innerHeight=window.innerHeight-232}}},f={};var j=p(P,R,k,!1,B,"09006716",null,null);function B(e){for(let t in f)this[t]=f[t]}var q=function(){return j.exports}();export{q as default};
